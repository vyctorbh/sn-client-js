<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for src/Helpers/OData.ts</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="..\..\prettify.css" />
    <link rel="stylesheet" href="..\..\base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(..\..\sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="..\..\index.html">All files</a> / <a href="index.html">src/Helpers</a> OData.ts
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">13.56% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>8/59</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>0/41</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>0/7</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">13.56% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>8/59</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * @module ODataHelper
 * @preferred
 * 
 * @description Helper methods for OData Operations
 */ /** */
&nbsp;
// TODO: ezeket vhova kivezetni
import { IODataParams } from '../ODataApi';
&nbsp;
const ODATA_PARAMS = ['select', 'expand', 'orderby', 'top', 'skip', 'filter', 'format', 'inlinecount'];
export const DATA_ROOT = 'OData.svc';
&nbsp;
/**
 * Method to build proper parameter string to OData requests based on the given option Object.
 *
 * Checks whether a given parameter is standard OData param or not and based on this information this params get the '$' sign.
 *
 * If there's no select param given, or it is empty 'Id' is the default, so only this field will be on the content in the JSON result. To get all the field values, without selection, set it to 'all', but please avoid this if it's possible.
 * @param {IODataOptions} options Represents an ODataOptions obejct based through the IODataOptions interface. Holds the possible url parameters as properties.
 * @returns {string} String with the url params in the correct format e.g. '$select=DisplayName,Index'&amp;$top=2&amp;metadata=no'.
 */
export const buildUrlParamString: (options?: IODataParams) =&gt; string = <span class="fstat-no" title="function not covered" >(o</span>ptions?: IODataParams): string =&gt; {
<span class="cstat-no" title="statement not covered" >    if (typeof options === 'undefined') {</span>
<span class="cstat-no" title="statement not covered" >        return '';</span>
    }
    let params: string = <span class="cstat-no" title="statement not covered" >'?';</span>
<span class="cstat-no" title="statement not covered" >    if (typeof options.select !== 'undefined') {</span>
<span class="cstat-no" title="statement not covered" >        if (typeof options.select === 'string' &amp;&amp; options.select !== 'all') {</span>
            let value = <span class="cstat-no" title="statement not covered" >options.select;</span>
<span class="cstat-no" title="statement not covered" >            options.select = [value, 'Id', 'Type'];</span>
        }
        else <span class="cstat-no" title="statement not covered" >if (options.select !== 'all') {</span>
<span class="cstat-no" title="statement not covered" >            options.select = [...options.select, 'Id', 'Type']</span>
        }
        else {
<span class="cstat-no" title="statement not covered" >            delete options['select'];</span>
        }
    }
    else {
<span class="cstat-no" title="statement not covered" >        options.select = ['Id', 'Type'];</span>
    }
<span class="cstat-no" title="statement not covered" >    for (let key in options) {</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (typeof options[key] !== 'undefined') {</span>
<span class="cstat-no" title="statement not covered" >            if (ODATA_PARAMS.indexOf(key) &gt; -1) {</span>
<span class="cstat-no" title="statement not covered" >                params += `$${key}=`;</span>
<span class="cstat-no" title="statement not covered" >                if (typeof options[key] === 'string') {</span>
<span class="cstat-no" title="statement not covered" >                    params += options[key];</span>
                }
                else <span class="cstat-no" title="statement not covered" >if (typeof options[key] !== 'undefined') {</span>
<span class="cstat-no" title="statement not covered" >                    for (let x = 0; x &lt; options[key].length; x++) {</span>
<span class="cstat-no" title="statement not covered" >                        if (typeof options[key] !== 'undefined') {</span>
<span class="cstat-no" title="statement not covered" >                            params += `${options[key][x]}`;</span>
<span class="cstat-no" title="statement not covered" >                            if (x &lt; options[key].length - 1) {</span>
<span class="cstat-no" title="statement not covered" >                                params += `,`;</span>
                            }
                        }
                    }
                }
&nbsp;
            }
            else {
<span class="cstat-no" title="statement not covered" >                if (typeof options[key] !== 'undefined') {</span>
<span class="cstat-no" title="statement not covered" >                    params += `${key}=${options[key]}`;</span>
                }
            }
<span class="cstat-no" title="statement not covered" >            params += `&amp;`;</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    if (typeof options.metadata === 'undefined') {</span>
<span class="cstat-no" title="statement not covered" >        params += 'metadata=no&amp;';</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return params.slice(0, params.length - 1);</span>
}
/**
 * Method to help building body part of a POST OData request.
 *
 * Converts the given JSON to string and wraps it into a 'models' array.
 * @param options
 * @returns {string} Models array with the given options in string format e.g. 'models=["{ '__ContentType':'EventList' , 'DisplayName': 'Calendar', 'Index': 2 }"]'.
 */
export const buildRequestBody = <span class="fstat-no" title="function not covered" >(o</span>ptions) =&gt; {
    let stringifiedOptions = <span class="cstat-no" title="statement not covered" >JSON.stringify(options);</span>
<span class="cstat-no" title="statement not covered" >    return `models=[${stringifiedOptions}]`;</span>
}
/**
 * Method that gets the URL that refers to a single item in the Sense/Net Content Repository
 * @param path {string} Path that you want to format.
 * @returns {string} Path in entity format e.g. /workspaces('project') from /workspaces/project
 */
export const getContentURLbyPath: (path: string) =&gt; string = <span class="fstat-no" title="function not covered" >(p</span>ath: string): string =&gt; {
<span class="cstat-no" title="statement not covered" >    if (typeof path === 'undefined' || path.indexOf('/') &lt; 0 || path.length &lt;= 1) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error('This is not a valid path.');</span>
    }
<span class="cstat-no" title="statement not covered" >    if (isItemPath(path))</span>
<span class="cstat-no" title="statement not covered" >        return path;</span>
&nbsp;
    let lastSlashPosition = <span class="cstat-no" title="statement not covered" >path.lastIndexOf('/');</span>
    let name = <span class="cstat-no" title="statement not covered" >path.substring(lastSlashPosition + 1);</span>
    let parentPath = <span class="cstat-no" title="statement not covered" >path.substring(0, lastSlashPosition);</span>
&nbsp;
    let url;
<span class="cstat-no" title="statement not covered" >    if (name.indexOf('Root') &gt; -1)</span>
<span class="cstat-no" title="statement not covered" >        url = `${parentPath}/('${name}')`;</span>
    else
<span class="cstat-no" title="statement not covered" >        url = `${parentPath}('${name}')`</span>
<span class="cstat-no" title="statement not covered" >    return url;</span>
}
/**
 * Method that gets the URL that refers to a single item in the Sense/Net Content Repository by its Id
 * @param id {number} Id of the Content.
 * @returns {string} e.g. /content(123)
 */
export const getContentUrlbyId: (id: number) =&gt; string = <span class="fstat-no" title="function not covered" >(i</span>d: number) =&gt; {
<span class="cstat-no" title="statement not covered" >    return `/content(${id})`;</span>
}
/**
 * Method that tells if a path is an item path.
 * @param path {string} Path that you want to test.
 * @returns {boolean} Returns if the given path is a path of a Content or not.
 */
export const isItemPath: (path: string) =&gt; boolean = <span class="fstat-no" title="function not covered" >(p</span>ath) =&gt; {
<span class="cstat-no" title="statement not covered" >    return path.indexOf("('") &gt;= 0 &amp;&amp; path.indexOf("')") === path.length - 2;</span>
}
&nbsp;
/**
 * Method that allows to join paths without multiple or missing slashes
 * @param args The list of the paths to join
 */
export const joinPaths = <span class="fstat-no" title="function not covered" >(.</span>..args: string[]) =&gt; {
    const trimSlashes = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >(p</span>ath: string) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >        if (path.endsWith('/')) {</span>
<span class="cstat-no" title="statement not covered" >            path = path.substring(0, path.length - 1)</span>
        }
<span class="cstat-no" title="statement not covered" >        if (path.startsWith('/')) {</span>
<span class="cstat-no" title="statement not covered" >            path = path.substring(1, path.length);</span>
        }
<span class="cstat-no" title="statement not covered" >        return path;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return args.map(trimSlashes).join('/');</span>
}</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="https://istanbul.js.org/" target="_blank">istanbul</a> at Fri Jun 30 2017 11:36:08 GMT+0200 (Central Europe Daylight Time)
</div>
</div>
<script src="..\..\prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="..\..\sorter.js"></script>
</body>
</html>
